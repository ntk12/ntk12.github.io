{
  "version": "https://jsonfeed.org/version/1",
  "title": "Kha&#39;s - Journeys and times of me",
  "home_page_url": "https://lotusirous.github.io/",
  "feed_url": "https://lotusirous.github.io/feed/feed.json",
  "description": "This place is a note for myself",
  "author": {
    "name": "Your Name Here",
    "url": "https://lotusirous.github.io/about-me/"
  },
  "items": [{
      "id": "https://lotusirous.github.io/posts/byte-order-in-go/",
      "url": "https://lotusirous.github.io/posts/byte-order-in-go/",
      "title": "How to Detect Byte Order in Go",
      "content_html": "<p>Byte order, also known as endianness, refers to the way in which a computer\nstores the individual bytes of a multi-byte data type in its memory.\nLittle-endian systems store the least significant byte at the lowest memory\naddress, while big-endian systems store the most significant byte at the lowest\nmemory address</p>\n<p>To detect the byte order of a system when working at a low level, you can use\nthe following snippet:</p>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">var</span> Endian binary<span class=\"token punctuation\">.</span>ByteOrder<br><br><span class=\"token keyword\">var</span> IsBigEndian <span class=\"token builtin\">bool</span><br><br><span class=\"token keyword\">func</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>\tb <span class=\"token operator\">:=</span> <span class=\"token function\">uint16</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// one byte</span><br>\t<span class=\"token keyword\">if</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token builtin\">byte</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>unsafe<span class=\"token punctuation\">.</span><span class=\"token function\">Pointer</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">{</span><br>\t\tEndian <span class=\"token operator\">=</span> binary<span class=\"token punctuation\">.</span>BigEndian<br>\t\tIsBigEndian <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><br>\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span><br>\t\tEndian <span class=\"token operator\">=</span> binary<span class=\"token punctuation\">.</span>LittleEndian<br>\t\tIsBigEndian <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><br>\t<span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span></code></pre>\n<p>In this particular case, the <code>0xff</code> value is being used as a sentinel value to\ndetect the byte order of the system. The <code>0xff</code> value is chosen because it\nconsists of all 1 bits, which means that the most significant bit of the value\nwill be set to 1.</p>\n<p>In a big-endian system, the most significant byte (which in this case would be\n<code>0xff)</code> would be stored at the lowest memory address. Therefore, if the byte\npointed to by the <code>unsafe.Pointer</code> function is equal to 0, it means that the\nsystem is using a big-endian byte order because the 0xff value has been\n&quot;truncated&quot; to just <code>0x00</code> due to the fact that the system is only storing the\nleast significant byte at the lowest memory address.</p>\n",
      "date_published": "2022-12-13T00:00:00Z"
    },{
      "id": "https://lotusirous.github.io/posts/golink/",
      "url": "https://lotusirous.github.io/posts/golink/",
      "title": "Golink - URL shorten service",
      "content_html": "<p>This is the note that I have learn from analyzing pro golang code. The first\npost in this series is <code>golink</code>.</p>\n<h1>Golink</h1>\n",
      "date_published": "2022-12-01T00:00:00Z"
    },{
      "id": "https://lotusirous.github.io/posts/function-snippet-for-go/",
      "url": "https://lotusirous.github.io/posts/function-snippet-for-go/",
      "title": "Generate return values in Neovim for Go.",
      "content_html": "<p>I'm a big fan of error handling in Go because of its clarity and simplicity.\nHowever, I sometimes find it tedious to have to type <code>if err != nil</code> for every\nerror handling error. That's why I'm excited to share with you a new technique\nthat I've discovered for reducing the number of keystrokes needed for error\nhandling in Go. By combining the\n<a href=\"https://github.com/nvim-treesitter/nvim-treesitter\">nvim-treesitter</a> and\n<a href=\"https://github.com/L3MON4D3/LuaSnip\">LuaSnip</a> tools, you can easily generate\nthe return values for your error handling errors, saving you time and making\nyour code more efficient.</p>\n<p>In this post, I'll explain how to set up and use this technique, so that you can\nenjoy the benefits of error handling in Go without all the tedious typing.</p>\n<h2>Tree-sitter and LuaSnip</h2>\n<p><strong>Tree-sitter</strong> is a parser generator tool that can build parsers for\nprogramming languages. It uses incremental parsing to quickly and accurately\nparse source code as it is being edited. In Go, tree-sitter can generate an\nabstract syntax tree (AST) for a Go source file, which can be used for code\nanalysis, code completion, or code generation.</p>\n<p><strong>LuaSnip</strong> is a neovim plugin that allows users to define and manage code\nsnippets using Lua. It can save time and improve productivity by allowing users\nto insert code snippets quickly and easily. It also offers features like\ncontext-aware expansion, completion, and arguments.</p>\n<h2>Generate the snippet</h2>\n<p>This code defines a tree-sitter query for Go source code that uses the <code>set_query</code> function from the <code>vim.treesitter</code> module. The query is stored in a variable called <code>LuaSnip_Result</code>, and it searches for three different types of declarations in Go source code: method declarations, function declarations, and function literals.</p>\n<p>For each of these declarations, the query stores the result in a variable called <code>@id</code>, which can be used later to reference the specific declaration that was found. The query uses the tree-sitter query language, which is a syntax for defining and running queries on abstract syntax trees (ASTs) generated by tree-sitter parsers.</p>\n<p>The second part of the code creates a code snippet called &quot;iferr&quot; that uses the results of the <code>LuaSnip_Result</code> query to automatically generate the return values for the function or method specified in the &quot;f&quot; input field. This can save you time and effort. When you type &quot;iferr&quot; the result will match the function and returned value from the method.</p>\n<pre class=\"language-lua\"><code class=\"language-lua\">vim<span class=\"token punctuation\">.</span>treesitter<span class=\"token punctuation\">.</span><span class=\"token function\">set_query</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"go\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"LuaSnip_Result\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">[[<br>    (method_declaration result: (_) @id)<br>    (function_declaration result: (_) @id)<br>    (func_literal result: (_) @id)<br>]]</span><span class=\"token punctuation\">)</span><br><br><span class=\"token function\">s</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"iferr\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"val\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><br>    t <span class=\"token string\">\", \"</span><span class=\"token punctuation\">,</span><br>    <span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"err\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><br>    t <span class=\"token string\">\" := \"</span><span class=\"token punctuation\">,</span><br>    <span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"f\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><br>    <span class=\"token function\">t</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"if \"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><br>    <span class=\"token function\">same</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><br>    <span class=\"token function\">t</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\" != nil {\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\treturn \"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><br>    <span class=\"token function\">d</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> go_ret_vals<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><br>    <span class=\"token function\">t</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"}\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><br>    <span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><br><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre>\n<p>Let's give it a try.</p>\n<pre><code>iferr&lt;c-k&gt;\n</code></pre>\n<h2>Conclusion</h2>\n<p>In conclusion, this post has shown you how to use tree-sitter and LuaSnip to\ncreate a code snippet for Go development that can automatically generate the\nreturn values for error handling errors. This technique can improve your\nworkflow and make your code more efficient and effective. By using this\napproach, you can reduce the amount of time and effort you spend on error\nhandling in Go.</p>\n",
      "date_published": "2022-05-28T00:00:00Z"
    },{
      "id": "https://lotusirous.github.io/posts/smart-contract-practices/",
      "url": "https://lotusirous.github.io/posts/smart-contract-practices/",
      "title": "Smart contract hacking resources",
      "content_html": "<p>I'm using the following resources to build up the background to learn/hack the smart contract</p>\n<h2>Background</h2>\n<p>Books:</p>\n<ul>\n<li>Mastering Ethereum: Building Smart Contracts and DApps</li>\n<li>Building Ethereum DApps: Decentralized Applications on the Ethereum Blockchain</li>\n</ul>\n<p>Tutorials:</p>\n<ul>\n<li><a href=\"https://ethereum.org/en/developers/learning-tools/\">All tutorials and learning-by-coding from ETH</a></li>\n<li>Learn Solidity</li>\n<li><a href=\"https://cryptozombies.io/\">CryptoZombies</a></li>\n<li><a href=\"https://solidity-by-example.org/\">Solidity by Example</a></li>\n<li>Solidity Docs</li>\n<li>Learn how to use <a href=\"https://hardhat.org/\">HardHat</a></li>\n<li>Familiarize yourself with widely used contracts (EIP 20)</li>\n</ul>\n<h2>Challenges</h2>\n<ul>\n<li>Read writeups &amp; postmortems</li>\n<li>Do some CTF's</li>\n</ul>\n<h2>Resources</h2>\n<ul>\n<li><a href=\"https://youtu.be/M576WGiDBdQ\">Solidity, Blockchain, and Smart Contract Course – Beginner to Expert Python Tutorial</a></li>\n<li><a href=\"https://blog.sigmaprime.io/-solidity-security.html\">Solidity Security: Comprehensive list of known attack vectors and common anti-patterns</a></li>\n<li><a href=\"https://swcregistry.io/\">Smart Contract Weakness Classification and Test Cases</a></li>\n<li><a href=\"https://consensys.github.io/smart-contract-best-practices/\">Ethereum Smart Contract Security Best Practices</a></li>\n</ul>\n",
      "date_published": "2021-10-17T00:00:00Z"
    },{
      "id": "https://lotusirous.github.io/posts/flare-on-challenge-1/",
      "url": "https://lotusirous.github.io/posts/flare-on-challenge-1/",
      "title": "[Flare on 2020] Level 1",
      "content_html": "<p>This challenge is a python that have compiled to windows program. The organizer\nalso gives us a source code of this program. Let's dive into the code by static\nanalysis. We have the following functions</p>\n<pre class=\"language-txt\"><code class=\"language-txt\"> +buy_click : function<br> +cat_clicked : function<br> +decode_flag : function &lt;--<br> +game_screen : function<br> +main : function<br> +password_check : function &lt;--<br> +password_fail_screen : function<br> +password_screen : function<br> +victory_screen : function<br>▼ variables<br>    buying<br>    current_autoclickers<br>    current_coins</code></pre>\n<p>It looks like the program has several functions that may be of interest to us.\nIn particular, the <code>password_check</code> and <code>decode_flag</code> functions stand out as\npotentially important.</p>\n<p>To start, let's take a closer look at the <code>password_check</code> function. This\nfunction is likely responsible for verifying the user's password, so it will be\nimportant to understand how it works and what it does. We can examine the code\nline by line to see what it does and how it operates.</p>\n<p>Next, let's move on to the <code>decode_flag</code> function. This function is probably\nresponsible for decoding the flag that we need to find in order to solve the\nchallenge. By analyzing the code in this function, we can learn more about how\nthe flag is encoded and what we need to do to decode it.</p>\n<p><strong>The <code>password_check</code> function</strong></p>\n<p>Since the program requires user to enter a password with a protect screen, the\ndeveloper implements this feature by 2 functions:</p>\n<ul>\n<li><code>password_screen</code> shows the input text.</li>\n<li><code>password_check</code> checks the password as follows</li>\n</ul>\n<pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">def</span> <span class=\"token function\">password_check</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><br>    altered_key <span class=\"token operator\">=</span> <span class=\"token string\">\"hiptu\"</span><br>    key <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> altered_key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><br>    <span class=\"token keyword\">return</span> <span class=\"token builtin\">input</span> <span class=\"token operator\">==</span> key</code></pre>\n<p>The solution is trivial, they key is &quot;ghost&quot; by running the code in python\ninterpreter</p>\n<pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token string\">\"hiptu\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre>\n<p><strong>The <code>decode_flag</code> function</strong></p>\n<p>I discovered that the <code>victory_screen</code> function calls the <code>decode_flag</code> function\nby using the &quot;find references&quot; feature from the Language Server Protocol (LSP).\nThe <code>game_screen</code> function calculates the token value using the following logic:</p>\n<pre class=\"language-py\"><code class=\"language-py\">target_amount <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">36</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">35</span><span class=\"token punctuation\">)</span><br><span class=\"token keyword\">if</span> current_coins <span class=\"token operator\">></span> <span class=\"token punctuation\">(</span>target_amount <span class=\"token operator\">-</span> <span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><br>    <span class=\"token keyword\">while</span> current_coins <span class=\"token operator\">>=</span> <span class=\"token punctuation\">(</span>target_amount <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><br>        current_coins <span class=\"token operator\">-=</span> <span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">20</span><br>    victory_screen<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>current_coins <span class=\"token operator\">/</span> <span class=\"token number\">10</span> <span class=\"token operator\">**</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><br>    <span class=\"token keyword\">return</span></code></pre>\n<p>In order to display the victory screen and see the flag, the <code>current_coins</code>\nvariable must have a value greater than <code>(target_amount - 2 ** 20)</code>. To achieve\nthis, we can use the following code:</p>\n<pre class=\"language-python\"><code class=\"language-python\">target_amount <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">36</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">35</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span>  <span class=\"token comment\"># +1 to jump inside the while loop.</span><br>current_coins <span class=\"token operator\">=</span> target_amount <span class=\"token operator\">-</span> <span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">20</span><br><span class=\"token keyword\">while</span> current_coins <span class=\"token operator\">>=</span> <span class=\"token punctuation\">(</span>target_amount <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><br>    current_coins <span class=\"token operator\">-=</span> <span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">20</span><br>token <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>current_coins <span class=\"token operator\">/</span> <span class=\"token number\">10</span> <span class=\"token operator\">**</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span></code></pre>\n<p>With the <code>token</code> value calculated, we can now call the <code>decode_flag</code> function to\ndecode the flag and print it to the screen:</p>\n<pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>decode_flag<span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><br>idle_with_kitty@flare<span class=\"token operator\">-</span>on<span class=\"token punctuation\">.</span>com</code></pre>\n",
      "date_published": "2020-10-17T00:00:00Z"
    }
  ]
}
