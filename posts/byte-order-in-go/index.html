<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="theme-color" content="#680"><title>How to Detect Byte Order in Go</title><meta name="description" content="How to Detect Byte Order in Go."><link rel="stylesheet" href="/css/prism-base16-monokai.dark.css"><link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Kha&#39;s - Journeys and times of me"><link rel="alternate" href="/feed/feed.json" type="application/json" title="Kha&#39;s - Journeys and times of me"><link rel="stylesheet" href="/css/index.css"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({
        startOnLoad: true,
        theme: "forest",
      });</script></head><body><div class="topnav"><div class="topnav-content"><a href="/" style="vertical-align: middle"><img src="/img/home.svg" alt="home icon" align="middle" height="18" width="18"> <span>Kha</span> </a><a href="/research">Research</a> <a href="/blog">Blog</a><div class="topnav-right"><a href="https://github.com/lotusirous" target="_blank" rel="noreferrer" title="Github"><img alt="Github" src="/img/social/github.svg" height="20" width="20"></a><a href="https://twitter.com/__ngtrongkha" target="_blank" rel="noreferrer" title="Twitter"><img alt="Twitter" src="/img/social/twitter.svg" height="20" width="20"></a></div></div></div><div id="content"><div id="main"><main><div class="article"><div class="when"><time datetime="Dec 13, 2022">Dec 13, 2022</time></div><h1 class="post-title">How to Detect Byte Order in Go</h1><p>The <a href="https://github.com/josharian/native">native package</a> contains a method for detecting byte order in Go. While this can sometimes lead to program portability issues, understanding how the package works can greatly improve the developer experience.</p><p>Byte order, also known as endianness, refers to the way in which a computer stores the individual bytes of a multi-byte data type in its memory. Little-endian systems store the least significant byte at the lowest memory address, while big-endian systems store the most significant byte at the lowest memory address</p><p>To detect the byte order of a system when working at a low level, you can use the following snippet:</p><pre class="language-go"><code class="language-go"><span class="token keyword">var</span> Endian binary<span class="token punctuation">.</span>ByteOrder

<span class="token keyword">var</span> IsBigEndian <span class="token builtin">bool</span>

<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	b <span class="token operator">:=</span> <span class="token function">uint16</span><span class="token punctuation">(</span><span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token comment">// one byte</span>
	<span class="token keyword">if</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token builtin">byte</span><span class="token punctuation">)</span><span class="token punctuation">(</span>unsafe<span class="token punctuation">.</span><span class="token function">Pointer</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
		Endian <span class="token operator">=</span> binary<span class="token punctuation">.</span>BigEndian
		IsBigEndian <span class="token operator">=</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		Endian <span class="token operator">=</span> binary<span class="token punctuation">.</span>LittleEndian
		IsBigEndian <span class="token operator">=</span> <span class="token boolean">false</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>In this particular case, the <code>0xff</code> value is being used as a sentinel value to detect the byte order of the system. The <code>0xff</code> value is chosen because it consists of all 1 bits, which means that the most significant bit of the value will be set to 1.</p><p>In a big-endian system, the most significant byte (which in this case would be <code>0xff</code>) would be stored at the lowest memory address. Therefore, if the byte pointed to by the <code>unsafe.Pointer</code> function is equal to 0, it means that the system is using a big-endian byte order because the <code>0xff</code> value has been &quot;truncated&quot; to just <code>0x00</code> due to the fact that the system is only storing the least significant byte at the lowest memory address.</p><div class="direction"><div class="next">« <a href="/posts/zero-allocated-byte-to-string/">Zero allocated byte to string conversion</a></div><div class="previous"><a href="/posts/flare-on-challenge-1/">Flare on 2020 - Level 1</a> »</div></div></div></main></div></div><footer></footer></body></html>