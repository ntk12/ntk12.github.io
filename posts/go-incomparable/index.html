<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="theme-color" content="#680"><title>Enforcing Field Names in Go</title><meta name="description" content="This place is a note for myself"><link rel="stylesheet" href="/css/prism-base16-monokai.dark.css"><link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Kha&#39;s - Journeys and times of me"><link rel="alternate" href="/feed/feed.json" type="application/json" title="Kha&#39;s - Journeys and times of me"><link rel="stylesheet" href="/css/index.css"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({
        startOnLoad: true,
        theme: "forest",
      });</script></head><body><div class="topnav"><div class="topnav-content"><a href="/" style="vertical-align: middle"><img src="/img/home.svg" alt="home icon" align="middle" height="18" width="18"> <span>Kha</span> </a><a href="/research">Research</a> <a href="/blog">Blog</a><div class="topnav-right"><a href="https://github.com/lotusirous" target="_blank" rel="noreferrer" title="Github"><img alt="Github" src="/img/social/github.svg" height="20" width="20"></a><a href="https://twitter.com/__ngtrongkha" target="_blank" rel="noreferrer" title="Twitter"><img alt="Twitter" src="/img/social/twitter.svg" height="20" width="20"></a></div></div></div><div id="content"><div id="main"><main><div class="article"><div class="when"><time datetime="Nov 2, 2023">Nov 2, 2023</time></div><h1 class="post-title">Enforcing Field Names in Go</h1><p>In the world of Go programming, code maintainability and readability are essential aspects of writing efficient and robust software. One of the ways to achieve this is by enforcing the use of field names when initializing struct literals. This helps code reviewers and developers understand the purpose and context of the values assigned to each field. In this blog post, we'll explore a clever trick that forces users of an exported struct to include field names in their code, ensuring clarity and reducing potential issues down the road.</p><p>The Trick: The trick we're about to reveal is quite simple yet incredibly effective. It involves the use of a small, anonymous, and unused struct field to force users to write field names when creating struct literals. This technique has been discussed and well-documented in a Github issue (<a href="https://github.com/golang/go/issues/2794">https://github.com/golang/go/issues/2794</a>) and has found its way into various Go codebases.</p><p>Here's the trick in action:</p><pre class="language-go"><code class="language-go"><span class="token keyword">type</span> Struct <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    A <span class="token builtin">int</span>
    B <span class="token builtin">string</span>
    <span class="token boolean">_</span> <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// The trick</span>
<span class="token punctuation">}</span></code></pre><p>With this struct definition, any usage of Struct{1, &quot;2&quot;} will result in a compile error, prompting developers to specify field names.</p><p>Compile Error:</p><pre><code>./prog.go:4:16: too few values in Struct literal
</code></pre><p>The _ struct{} field serves as a clever reminder for the developer to be more explicit about their intentions when creating struct literals.</p><p>Why Use This Trick?</p><p>Clarity: By enforcing field names, code becomes self-documenting, making it easier for both authors and reviewers to understand the intent of the code. This leads to more maintainable and reliable code.</p><p>Avoid Bugs: When struct fields are explicitly named during initialization, it helps prevent bugs and unexpected behavior that might arise from the misplacement of values.</p><p>Compatibility: This trick works perfectly with the Go standard library and is compatible with other Go tools and packages</p><div class="direction"><div class="previous"><a href="/posts/semgrep-with-vim/">Using semgrep in vim</a> Â»</div></div></div></main></div></div><footer></footer></body></html>